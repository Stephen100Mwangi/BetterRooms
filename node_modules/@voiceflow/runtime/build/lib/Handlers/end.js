"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const general_types_1 = require("@voiceflow/general-types");
const EndHandler = () => ({
    canHandle: (node) => !!node.end,
    handle: (_, runtime) => {
        runtime.stack.top().setNodeID(null);
        // pop all program frames that are already ended
        while (!runtime.stack.top().getNodeID() && !runtime.stack.isEmpty()) {
            runtime.stack.pop();
        }
        runtime.turn.set('end', true);
        runtime.trace.addTrace({ type: general_types_1.TraceType.END, payload: null });
        runtime.trace.debug('exiting session - saving location/resolving stack');
        runtime.end();
        return null;
    },
});
exports.default = EndHandler;
//# sourceMappingURL=end.js.map